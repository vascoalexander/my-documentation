"use strict";(self.webpackChunkmy_documentation=self.webpackChunkmy_documentation||[]).push([[8169],{33570:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>d,default:()=>c,frontMatter:()=>m,metadata:()=>i,toc:()=>s});const i=JSON.parse('{"id":"DB/ProjectDB/projektdb08-outerjoin2","title":"OUTER JOIN II","description":"","source":"@site/docs/06-DB/04-ProjectDB/projektdb08-outerjoin2.md","sourceDirName":"06-DB/04-ProjectDB","slug":"/DB/ProjectDB/projektdb08-outerjoin2","permalink":"/my-documentation/docs/DB/ProjectDB/projektdb08-outerjoin2","draft":false,"unlisted":false,"editUrl":"https://github.com/vascoalexander/my-documentation/tree/main/docs/06-DB/04-ProjectDB/projektdb08-outerjoin2.md","tags":[],"version":"current","sidebarPosition":16,"frontMatter":{"sidebar_position":16,"description":"","draft":false,"title":"OUTER JOIN II"},"sidebar":"dbSidebar","previous":{"title":"OUTER JOIN I","permalink":"/my-documentation/docs/DB/ProjectDB/projektdb08-outerjoin1"},"next":{"title":"CASE","permalink":"/my-documentation/docs/DB/ProjectDB/projektdb09-case"}}');var a=t(74848),r=t(28453);const m={sidebar_position:16,description:"",draft:!1,title:"OUTER JOIN II"},d=void 0,u={},s=[];function o(e){const n={code:"code",pre:"pre",...(0,r.R)(),...e.components};return(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"-- Nutzen Sie die Datenbank ProjektDB, \n-- um die folgenden Aufgaben zu l\xf6sen:\n\n\n-- Aufgabe 8.9\n--\n-- Zeigen Sie alle Mitarbeiter mit Id und nachname an\n-- und geben Sie dazu die vom Mitarbeiter get\xe4tigten\n-- Ums\xe4tze aus. Hat der Mitarbeiter noch keine Ums\xe4tze\n-- get\xe4tigt, soll in der Spalte Umsatz 0 angezeigt werden.\n--\n--      id     nachname  umsatz\n--      2581   Kaufmann  100000,00\n--      5765   Sch\xe4fer   0,00\n--      9031   Meier     0,00\n--      9912   Wolf      0,00\n--      10102  Huber     500,00\n--      10102  Huber     500,00\n--      ...\n--      (36 Zeilen)\n\nSELECT m.id, m.nachname, ISNULL(u.umsatz, 0) as umsatz\nFROM Mitarbeiter m\nLEFT JOIN Umsatz u ON m.id = u.mit_id\n\n-- Aufgabe 8.10\n--\n-- \xdcberarbeiten Sie die Abfrage aus Aufgabe 8.9.\n-- Zeigen Sie diesmal nur die Mitarbeiter an, die\n-- noch keine Ums\xe4tze get\xe4tigt haben.\n--\n--      id     nachname  umsatz\n--      5765   Sch\xe4fer   0,00\n--      9031   Meier     0,00\n--      9912   Wolf      0,00\n--      12121  Richter   0,00\n--      18316  M\xfcller    0,00\n--      20204  Fuchs     0,00\n--      ...\n--      (11 Zeilen)\n\nSELECT m.id, m.nachname, ISNULL(u.umsatz, 0) as umsatz\nFROM Mitarbeiter m\nLEFT JOIN Umsatz u ON m.id = u.mit_id\nWHERE u.umsatz IS NULL;\n\n-- Aufgabe 8.11\n--\n-- \xdcberarbeiten Sie die Abfrage aus Aufgabe 8.9.\n-- Gruppieren Sie \xfcber die Mitarbeiter und geben \n-- Sie statt der einzelnen Ums\xe4tze die Summe der\n-- Ums\xe4tze f\xfcr jeden Mitarbeiter aus. Fehlende\n-- Ums\xe4tze sollen weiterhin mit 0 angezeigt werden.\n--\n--      id     nachname  umsatz\n--      2581   Kaufmann  100000,00\n--      5765   Sch\xe4fer   0,00\n--      9031   Meier     0,00\n--      9912   Wolf      0,00\n--      10102  Huber     18000,00\n--      12121  Richter   0,00\n--      ...\n--      (15 Zeilen)\n\nSELECT m.id, m.nachname, SUM(ISNULL(u.umsatz, 0)) as umsatz\nFROM Mitarbeiter m\nLEFT JOIN Umsatz u ON m.id = u.mit_id\nGROUP BY m.id, m.nachname;\n\n\n-- Aufgabe 8.12\n--\n-- \xdcberarbeiten Sie die Abfrage aus Aufgabe 8.11.\n-- Zeigen Sie nur die Mitarbeiter an, die weniger\n-- als 100000 Umsatz erreicht haben.\n--\n--      id     nachname  umsatz\n--      5765   Sch\xe4fer   0,00\n--      9031   Meier     0,00\n--      9912   Wolf      0,00\n--      10102  Huber     18000,00\n--      12121  Richter   0,00\n--      17000  Kr\xfcger    20000,00\n--      ...\n--      (13 Zeilen)\n\nSELECT m.id, m.nachname, SUM(ISNULL(u.umsatz, 0)) as umsatz\nFROM Mitarbeiter m\nLEFT JOIN Umsatz u ON m.id = u.mit_id\nGROUP BY m.id, m.nachname\nHAVING SUM(ISNULL(u.umsatz, 0)) < 100000;\n\n-- Aufgabe 8.13\n--\n-- Zeigen Sie alle Mitarbeiter der Abteilung 'a2' mit \n-- Id und Nachname an und geben Sie dazu die vom Mitarbeiter \n-- get\xe4tigten Ums\xe4tze aus. Hat der Mitarbeiter noch keine \n-- Ums\xe4tze get\xe4tigt, soll in der Spalte Umsatz eine 0 \n-- angezeigt werden.\n--\n--      id     nachname  umsatz\n--      2581   Kaufmann  100000\n--      9031   Meier     0\n--      29346  Probst    0\n\nSELECT m.id, m.nachname, ISNULL(SUM(u.umsatz), 0) as umsatz\nFROM Mitarbeiter m\nLEFT JOIN  Umsatz u ON m.id = u.mit_id\nWHERE m.abt_id = 'a2'\nGROUP BY m.id, m.nachname;\n\n-- Aufgabe 8.14\n--\n-- Zeigen Sie alle Mitarbeiter mit Id und Nachname an\n-- und geben Sie dazu aus, an welchem Tag der Mitarbeiter\n-- zum ersten Mal einen Umsatz erzielt hat und wann er\n-- zum letzten Mal einen Umsatz erzielt hat.\n--\n--      id     nachname  erster      letzter\n--      2581   Kaufmann  2019-05-01  2019-05-01\n--      5765   Sch\xe4fer   NULL        NULL\n--      9031   Meier     NULL        NULL\n--      9912   Wolf      NULL        NULL\n--      10102  Huber     2018-10-01  2019-01-01\n--      12121  Richter   NULL        NULL\n--      ...\n--      (15 Zeilen)\n\nSELECT m.id, m.nachname, MIN(u.datum) as erster, MAX(u.datum) as letzter\nFROM Mitarbeiter m\nLEFT JOIN  Umsatz u ON m.id = u.mit_id\nGROUP BY m.id, m.nachname;\n\n-- Aufgabe 8.15\n-- \n-- Listen Sie alle Mitarbeiter mit m_nr und m_name\n-- auf. Zus\xe4tzlich soll das Projekt genannt werden,\n-- in dem der Mitarbeiter Projektleiter ist. Sollte \n-- es kein passendes Projekt geben, soll '- k. A. -'\n-- statt des Projektnamens angezeigt werden.\n--\n--      id     nachname  projekt\n--      2581   Kaufmann  Merkur\n--      5765   Sch\xe4fer   Pluto\n--      9031   Meier     - k. A. -\n--      9912   Wolf      - k. A. -\n--      10102  Huber     Apollo\n--      12121  Richter   - k. A. -\n--      ...\n--      (15 Zeilen)\n\nSELECT m.id, m.nachname, ISNULL(p.bezeichnung, '- k. A. -') as projekt\nFROM Mitarbeiter m\nLEFT JOIN Arbeit a ON a.mit_id = m.id AND a.aufgabe = 'Projektleiter'\nLEFT JOIN Projekt p ON a.pro_id = p.id;\n\nSELECT m.id, m.nachname, ISNULL(p.bezeichnung, '- k. A. -') AS bezeichnung\nFROM Mitarbeiter m\nOUTER APPLY (\n\tSELECT bezeichnung FROM Projekt p\n\tINNER JOIN Arbeit a ON a.pro_id = p.id\n\tWHERE a.aufgabe = 'Projektleiter' AND a.mit_id = m.id\n) AS p;\n"})})}function c(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>m,x:()=>d});var i=t(96540);const a={},r=i.createContext(a);function m(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:m(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);